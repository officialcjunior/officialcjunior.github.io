<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Look Into The Past - Writeup from NeverlanCTF | Aswin's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu><li><a href=/>home</a></li><li><a href=/projects/>projects</a></li><li><a href=/about/>about</a></li><li><a href=/cv/>cv/resume</a></li></ul><hr></nav><div class=article-meta><h2><span class=title>Look Into The Past - Writeup from NeverlanCTF</span></h2><h5 class=date>2019-10-13</h5></div><main><h1 id=neverlan-ctf-look-into-the-past>Neverlan CTF: Look into the past</h1><p>We played NeverLAN CTF and had so much fun playing it.</p><p>In the Forensics section, there was this task named Look into the past, which was really fun to solve.
So, I thought I&rsquo;d just write something about it.</p><p>You can find the challenge file <a href=https://github.com/victorazzam/stash/blob/master/Challenges/NeverLAN%202020/Forensics/Look%20into%20the%20past/look_into_the_past.tar.gz>here</a>.</p><p>After taking a look at the filesystem unzipping the challenge file, it is clear that this is a snapshot of a Linux file system.</p><p>Let&rsquo;s take a look at the clue again.</p><p><code>'but it seems the user was able to encrypt a file before we got to it'</code></p><p>Let&rsquo;s see what the user did, and that is, the bash history.</p><p><code>vi home/User/./bash_history</code></p><img src=/images/neverlan/1.png alt="Italian Trulli" width=800 height=500><p>There&rsquo;s quite a lot to unpack here.</p><p>Clearly, the flag.txt.enc is AES encrypted with a key that has three parts.</p><p>One has something to do with <code>stegihde</code>, another with <code>sqllie3</code> and and the other with <code>useradd</code>.</p><p>We must hunt for all of those three passwords.
Let&rsquo;s start with the easiest one.</p><p>As you can see, <code>pass3</code> is inserted into a database called <code>table.db</code> using sqlite3. Let&rsquo;s go check what&rsquo;s happening over there at <code>/opt/table.db</code>.</p><p>You&rsquo;ll encounted a zipped package and a database file when unzipped. Open it with a DBMS if you have one, otherwise, just take a look at the ASCII strings.</p><img src=/images/neverlan/2.png alt="Italian Trulli" width=600 height=200><p><code>nBNfDKbP5n</code> is pass3, the third part of our password.</p><p>Now for pass2.
You can see that the name of the user added was pass2.
So, let&rsquo;s go over there <code>/etc/shadows/</code> and see who the new user is.</p><img src=/images/neverlan/3.png alt="Italian Trulli" width=700 height=500><p><code>KI6VWx09JJ</code></p><p>So, that&rsquo;s pass2.</p><p>Now for pass1.
Well, pass1 was used to hide something inside doggo.jpg using steghide(More about steghide and other image forensics tools <a href=https://wiki.bi0s.in/forensics/Tools/>here</a>).</p><p>Let&rsquo;s try to extract that out.</p><p>Just hit enter while prompted to enter the passphrase.</p><img src=/images/neverlan/4.png alt="Italian Trulli" width=500 height=300><p>pass3 is JXrTLzijLb</p><p>Now, that you&rsquo;ve got them all, you just need to decrypt it, using <code>openssl</code>.</p><p>Combining them all, decrypting the .enc with the combined string as the key,</p><img src=/images/neverlan/5.png alt="Italian Trulli" width=550 height=450><p><code>flag{h1st0ry_1n_th3_m4k1ng}</code></p><p>Fun!</p></main><footer><script src=//yihui.org/js/math-code.js></script><script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script async src=//yihui.org/js/center-img.js></script><hr>Aswin&rsquo;s blog<br><a href=/index.xml>subscribe</a></footer></body></html>